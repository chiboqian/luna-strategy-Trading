

  # Example 5: Trend Monitor (Price > SMA 5)
  # Triggers when the 1-minute closing price is above the 5-minute SMA.
  # Note: Requires 'trigger: bar' and takes 5 minutes of runtime to initialize.
  - name: "QQQ Uptrend Detected"
    symbol: "QQQ"
    asset_class: "stock"
    trigger: "bar"  # Important: Use bar data (1-min candles) instead of quotes
    condition:
      field: "close"
      operator: ">"
      value: "sma_5"
    action:
      commands:
        - "echo 'QQQ Trend Up: Close {close} > SMA_5' >> trend_log.txt"
        - "./Trading/alpaca_buy_cli.py  --mid-price --stop-loss-pct 1 --take-profit-pct 2  tqqq 5000"
    cooldown: 60

  # Example 6: Golden Cross (SMA 50 > SMA 200)
  # Detects when the 50-period SMA is above the 200-period SMA on 1-minute bars.
  # Note: Requires ~200 minutes of runtime to populate the history before triggering.
  - name: "SPY Golden Cross (1-min)"
    symbol: "SPY"
    asset_class: "stock"
    trigger: "bar"
    condition:
      field: "sma_50"
      operator: ">"
      value: "sma_200"
    action:
      commands:
        - "echo 'Golden Cross Detected for {symbol} at {timestamp}' >> golden_cross_log.txt"
        - "./Trading/alpaca_buy_cli.py  --mid-price --stop-loss-pct 1 --take-profit-pct 2  tqqq 5000"  
    cooldown: 3600 # Trigger once per hour while condition holds

  # Example 4: RSI Overbought
  # Triggers when SPY's RSI (14) goes above 70.
  - name: "SPY RSI Overbought Close"
    symbol: "SPY"
    asset_class: "stock"
    trigger: "bar"
    condition:
      field: "rsi_14"
      operator: ">"
      value: 70.0
    action:
      # This command would close any open SPY positions.
      # Note: manage_options.py would close ALL SPY positions for SPY.
      command: "{python} Trading/options_trading/manage_options.py --symbol SPY --sl 0.0 --tp 0.0" # --sl 0.0 --tp 0.0 implies immediate close
    cooldown: 3600 # Cooldown to prevent rapid re-triggering

  # Example 7: Death Cross (SMA 50 < SMA 200)
  # Detects when the 50-period SMA is below the 200-period SMA on 1-minute bars.
  - name: "SPY Death Cross (1-min)"
    symbol: "SPY"
    asset_class: "stock"
    trigger: "bar"
    condition:
      field: "sma_50"
      operator: "<"
      value: "sma_200"
    action:
      command: "echo 'Death Cross Detected for {symbol} at {timestamp}' >> death_cross_log.txt"
    cooldown: 3600

  # Example 8: VWAP Deviation (Price > VWAP + 2 StdDev)
  # Detects if the price is 2 standard deviations above the 50-period VWAP.
  # Useful for mean reversion strategies (overbought).
  - name: "SPY VWAP Upper Band Breach"
    symbol: "SPY"
    asset_class: "stock"
    trigger: "bar"
    condition:
      field: "z_score_vwap_50" # (Close - VWAP_50) / StdDev_50
      operator: ">"
      value: 2.0
    action:
      command: "echo 'Overbought: {symbol} is 2 SD above VWAP at {close}' >> vwap_log.txt"
    cooldown: 300

  # Example 9: VWAP Deviation (Price < VWAP - 2 StdDev)
  # Detects if the price is 2 standard deviations below the 50-period VWAP.
  # Useful for mean reversion strategies (oversold).
  - name: "SPY VWAP Lower Band Breach"
    symbol: "SPY"
    asset_class: "stock"
    trigger: "bar"
    condition:
      field: "z_score_vwap_50"
      operator: "<"
      value: -2.0
    action:
      command: "echo 'Oversold: {symbol} is 2 SD below VWAP at {close}' >> vwap_log.txt"
    cooldown: 300

  # Example 10: Inside Bollinger Bands (Consolidation)
  # Triggers when price is within 2 Standard Deviations of the 20-period SMA.
  # Uses the new 'abs<' operator to check if |Z-Score| < 2.0
  - name: "SPY Inside BB (Consolidation)"
    symbol: "SPY"
    asset_class: "stock"
    trigger: "bar"
    condition:
      field: "z_score_sma_20"
      operator: "abs<"
      value: 2.0
    action:
      command: "echo 'Consolidation: {symbol} is inside Bollinger Bands at {close}' >> bb_log.txt"
    cooldown: 300



  # Example 13: Multi-Condition Trigger (AND Logic)
  # Triggers when RSI is oversold AND Price is below SMA 200
  - name: "SPY Oversold Downtrend"
    symbol: "qqq"
    asset_class: "stock"
    trigger: "bar"
    conditions:
      - field: "rsi_14"
        operator: "<"
        value: 30.0
      - field: "close"
        operator: "<"
        value: "sma_200"
    action:
      # RSI < 30 suggests a bounce, so we execute a Long Call (Counter-trend trade)
      #command: "{python} Trading/options_trading/long_call.py {symbol} --amount 5000 --limit-order --days 30"
      command: "./Trading/alpaca_buy_cli.py  --mid-price --stop-loss-pct 1 --take-profit-pct 2  tqqq 5000"
    cooldown: 3600

  # Example 14: Opposite Trigger (Overbought Uptrend)
  # Triggers when RSI is overbought (> 70) AND Price is above SMA 200
  - name: "QQQ Overbought Uptrend"
    symbol: "qqq"
    asset_class: "stock"
    trigger: "bar"
    conditions:
      - field: "rsi_14"
        operator: ">"
        value: 70.0
      - field: "close"
        operator: ">"
        value: "sma_200"
    action:
      # RSI > 70 suggests a pullback, so we execute a Long Put (Mean Reversion trade)
      #command: "{python} Trading/options_trading/long_put.py {symbol} --amount 5000 --limit-order --days 30"
      command: "./Trading/./Trading/alpaca_short_sell_cli.py.py  --mid-price --stop-loss-pct 1 --take-profit-pct 2  tqqq 5000"
    cooldown: 3600